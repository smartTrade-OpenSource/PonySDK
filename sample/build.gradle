repositories {
    mavenCentral()
    maven {
        url "https://github.com/PonySDK/Maven/raw/master/ext"
    }
    maven {
        url "http://oss.sonatype.org/content/repositories/snapshots"
    }
}

ext {
    java2htmlVersion = '5.0'
}

dependencies {
    compile (
        project(':ponysdk'),
        
        'de.java2html:java2html:' + java2htmlVersion,
        
        'org.eclipse.jetty.websocket:websocket-client:' + jettyVersion
    )

    runtime (
        'com.google.gwt:gwt-codeserver:' + gwtVersion,

        'de.java2html:java2html:' + java2htmlVersion,
        
        'org.springframework:spring-aop:' + springVersion,
        'org.springframework:spring-expression:' + springVersion
    )
}

task runCodeServer(type: JavaExec) {
    classpath = project(':ponysdk').configurations.gwtdev
    classpath += sourceSets.main.runtimeClasspath
    main = 'com.google.gwt.dev.codeserver.CodeServer'
    args = [
        '-src', '../ponysdk/src/main/java', 
        '-generateJsInteropExports', '-noincremental',
        '-style', 'DETAILED',
        'com.ponysdk.core.PonyTerminalDebug'
    ]
    jvmArgs = ['-server', '-Xmx1024m']
}

task runSampleSpring(type: JavaExec) {
  classpath = sourceSets.main.runtimeClasspath
  classpath += files(buildDir.getAbsolutePath() + '/gwt')
  classpath += files(buildDir.getAbsolutePath() + '/resources')
  main = 'com.ponysdk.impl.main.MainSpring'
  jvmArgs = ['-server', '-Xmx512m','-Dlogback.configurationFile=etc/logback.xml']
}

task runSampleTrading(type: JavaExec) {
  classpath = sourceSets.main.runtimeClasspath
  classpath += files(buildDir.getAbsolutePath() + '/gwt')
  main = 'com.ponysdk.impl.main.Main'
  jvmArgs = ['-server', '-Xmx512m', '-Dponysdk.application.id=trading', '-Dponysdk.application.name="Trading sample"', '-Dponysdk.application.description="Trading Sample"',
             '-Dponysdk.application.context.name=trading', '-Dponysdk.entry.point.class=com.ponysdk.sample.client.TradingSampleEntryPoint',
             '-Dponysdk.application.javascripts=script/ponysdk.js;script/widget.js;script/sample.js;script/less.js', '-Dponysdk.application.stylesheets=css/sample.less;css/ponysdk.less' ]
}
